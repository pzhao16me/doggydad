---
// Giscus è¯„è®ºç»„ä»¶
---

<div class="comments-section">
  <h2 class="comments-title">ğŸ’¬ è¯„è®º</h2>
  <div id="giscus-container"></div>
</div>

<script>
  function loadGiscus() {
    const container = document.getElementById('giscus-container');
    if (!container) return;
    
    // æ¸…é™¤å·²æœ‰çš„ giscus
    container.innerHTML = '';
    
    // è·å–å½“å‰ä¸»é¢˜
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' 
      ? 'dark' 
      : 'light';
    
    const script = document.createElement('script');
    script.src = 'https://giscus.app/client.js';
    script.setAttribute('data-repo', 'pzhao16me/doggydad');
    script.setAttribute('data-repo-id', 'R_kgDOQm9RfQ');
    script.setAttribute('data-category', 'Q&A');
    script.setAttribute('data-category-id', 'DIC_kwDOQm9Rfc4Czxu_');
    script.setAttribute('data-mapping', 'pathname');
    script.setAttribute('data-strict', '0');
    script.setAttribute('data-reactions-enabled', '1');
    script.setAttribute('data-emit-metadata', '0');
    script.setAttribute('data-input-position', 'bottom');
    script.setAttribute('data-theme', theme);
    script.setAttribute('data-lang', 'zh-CN');
    script.setAttribute('data-loading', 'lazy');
    script.crossOrigin = 'anonymous';
    script.async = true;
    
    container.appendChild(script);
  }
  
  // åˆå§‹åŠ è½½
  loadGiscus();
  
  // ç›‘å¬ä¸»é¢˜åˆ‡æ¢
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.attributeName === 'data-theme') {
        // ä¸»é¢˜å˜åŒ–æ—¶é‡æ–°åŠ è½½ giscus
        const iframe = document.querySelector('iframe.giscus-frame');
        if (iframe) {
          const theme = document.documentElement.getAttribute('data-theme') === 'dark' 
            ? 'dark' 
            : 'light';
          iframe.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            'https://giscus.app'
          );
        }
      }
    });
  });
  
  observer.observe(document.documentElement, { attributes: true });
</script>

<style>
  .comments-section {
    margin-top: 4rem;
    padding-top: 2rem;
    border-top: 2px solid var(--color-border);
  }
  
  .comments-title {
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
    color: var(--color-text);
  }
  
  #giscus-container {
    min-height: 200px;
  }
</style>
